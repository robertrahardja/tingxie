<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®¶åº­ç§°å‘¼ - Family Relationships</title>
    <link rel="icon" href="data:,">
    <link rel="stylesheet" href="styles.css">
    <style>
        .family-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 80px 20px 20px 20px;
        }

        .family-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .family-header h1 {
            font-size: 1.8rem;
            color: #333;
            margin-bottom: 10px;
        }

        .family-header p {
            color: #666;
            font-size: 0.95rem;
        }

        .category-section {
            margin-bottom: 40px;
        }

        .category-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            font-size: 1.2rem;
            font-weight: 600;
            text-align: center;
        }

        .family-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
        }

        .family-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .family-card:active {
            transform: scale(0.98);
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.15);
        }

        .family-card .english {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .family-card .chinese {
            font-size: 1.8rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
            line-height: 1.3;
        }

        .family-card .pinyin {
            color: #4a90d9;
            font-size: 1rem;
            font-style: italic;
        }

        .family-card .audio-btn {
            background: #4a90d9;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 16px;
            margin-top: 10px;
            cursor: pointer;
            font-size: 0.9rem;
            width: 100%;
            transition: background 0.2s;
        }

        .family-card .audio-btn:hover {
            background: #357abd;
        }

        .family-card .audio-btn:active {
            background: #2d6aa3;
        }

        .tree-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 30px 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .tree-section h2 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .tree-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .tree-btn {
            background: #4a90d9;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.2s;
            font-weight: 600;
        }

        .tree-btn:hover {
            background: #357abd;
        }

        .tree-btn:active {
            background: #2d6aa3;
        }

        .tree-container {
            overflow: auto;
            -webkit-overflow-scrolling: touch;
            padding: 20px;
            background: white;
            border-radius: 8px;
            width: 100%;
            max-width: 100%;
        }

        .mermaid {
            display: inline-block;
            min-width: 100%;
            min-height: 600px;
            transform-origin: top left;
            transition: transform 0.2s ease;
        }

        .mermaid svg {
            display: block;
            max-width: none !important;
            width: auto !important;
            height: auto !important;
        }

        @media (max-width: 768px) {
            .tree-container {
                overflow-x: auto;
                overflow-y: auto;
            }

            .mermaid {
                min-height: 500px;
            }
        }

        .note {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
            font-size: 0.9rem;
            color: #856404;
        }

        @media (max-width: 600px) {
            .family-container {
                padding: 70px 15px 20px 15px;
            }

            .family-header h1 {
                font-size: 1.5rem;
            }

            .family-grid {
                grid-template-columns: 1fr;
            }

            .category-header {
                font-size: 1.1rem;
                padding: 12px 15px;
            }
        }
    </style>
</head>
<body>
    <nav class="main-nav">
        <div class="nav-container">
            <button class="menu-toggle" id="menu-toggle">
                <span class="hamburger"></span>
                <span class="hamburger"></span>
                <span class="hamburger"></span>
            </button>
            <div class="nav-menu" id="nav-menu">
                <a href="index.html" class="nav-item">æœ€æ–°è¯è¯­</a>
                <a href="review.html" class="nav-item">å¤ä¹ è¯è¯­</a>
                <a href="handwriting.html" class="nav-item">ç¬”ç”»ç»ƒä¹ </a>
                <a href="radicals.html" class="nav-item">éƒ¨é¦–å­¦ä¹ </a>
                <a href="family.html" class="nav-item active">å®¶åº­ç§°å‘¼</a>
                <a href="instructions.html" class="nav-item">æŒ‡ç¤ºè¯æ±‡</a>
                <a href="dashboard.html" class="nav-item">å®¶é•¿çœ‹æ¿</a>
            </div>
        </div>
    </nav>

    <div class="family-container">
        <header class="family-header">
            <h1>å®¶åº­ç§°å‘¼ Family Relationships</h1>
            <p>ç‚¹å‡»å¡ç‰‡å¬å‘éŸ³ Tap cards to hear pronunciation</p>
        </header>

        <div class="note">
            <strong>ğŸ’¡ æç¤º Tip:</strong> Chinese family terms are very specific about age order and which side of the family. Pay attention to these details!
        </div>

        <!-- Family Tree Visualization -->
        <div class="tree-section">
            <h2>ğŸŒ³ å®¶åº­å…³ç³»å›¾ Family Tree</h2>
            <div class="tree-controls">
                <button class="tree-btn" onclick="zoomIn()">ğŸ”+ Zoom In æ”¾å¤§</button>
                <button class="tree-btn" onclick="zoomOut()">ğŸ”- Zoom Out ç¼©å°</button>
                <button class="tree-btn" onclick="resetZoom()">â†º Reset é‡ç½®</button>
            </div>
            <div class="tree-container">
                <div class="mermaid">
flowchart TB
    subgraph FATHER_SIDE["ğŸ‘¨ çˆ¶ç³» Father's Side"]
        direction TB
        subgraph F_GP["ç¥–çˆ¶æ¯ Grandparents"]
            çˆ·çˆ·["ğŸ‘´ çˆ·çˆ·<br/>Grandfather"]:::male
            å¥¶å¥¶["ğŸ‘µ å¥¶å¥¶<br/>Grandmother"]:::female
        end

        subgraph F_PARENTS["çˆ¶è¾ˆ Parents Generation"]
            ä¼¯ä¼¯["ğŸ‘¨ ä¼¯ä¼¯<br/>Uncle (older)"]:::male
            çˆ¸çˆ¸["ğŸ‘¨ çˆ¸çˆ¸<br/>Father"]:::male
            å”å”["ğŸ‘¨ å”å”<br/>Uncle (younger)"]:::male
            å§‘å¦ˆ["ğŸ‘© å§‘å¦ˆ<br/>Aunt"]:::female
        end

        çˆ·çˆ· --> ä¼¯ä¼¯
        å¥¶å¥¶ --> ä¼¯ä¼¯
        çˆ·çˆ· --> çˆ¸çˆ¸
        å¥¶å¥¶ --> çˆ¸çˆ¸
        çˆ·çˆ· --> å”å”
        å¥¶å¥¶ --> å”å”
        çˆ·çˆ· --> å§‘å¦ˆ
        å¥¶å¥¶ --> å§‘å¦ˆ
    end

    subgraph MOTHER_SIDE["ğŸ‘© æ¯ç³» Mother's Side"]
        direction TB
        subgraph M_GP["å¤–ç¥–çˆ¶æ¯ Grandparents"]
            å¤–å…¬["ğŸ‘´ å¤–å…¬<br/>Grandfather"]:::male
            å¤–å©†["ğŸ‘µ å¤–å©†<br/>Grandmother"]:::female
        end

        subgraph M_PARENTS["æ¯è¾ˆ Parents Generation"]
            å¦ˆå¦ˆ["ğŸ‘© å¦ˆå¦ˆ<br/>Mother"]:::female
            èˆ…èˆ…["ğŸ‘¨ èˆ…èˆ…<br/>Uncle"]:::male
            å§¨å¦ˆ["ğŸ‘© å§¨å¦ˆ<br/>Aunt (older)"]:::female
            é˜¿å§¨["ğŸ‘© é˜¿å§¨<br/>Aunt (younger)"]:::female
        end

        å¤–å…¬ --> å¦ˆå¦ˆ
        å¤–å©† --> å¦ˆå¦ˆ
        å¤–å…¬ --> èˆ…èˆ…
        å¤–å©† --> èˆ…èˆ…
        å¤–å…¬ --> å§¨å¦ˆ
        å¤–å©† --> å§¨å¦ˆ
        å¤–å…¬ --> é˜¿å§¨
        å¤–å©† --> é˜¿å§¨
    end

    %% Dummy connector to force horizontal alignment
    FATHER_SIDE ~~~ MOTHER_SIDE

    subgraph YOUR_GEN["ğŸŸ¡ ä½ çš„ä¸€ä»£ Your Generation"]
        direction LR
        å“¥å“¥["ğŸ‘¦ å“¥å“¥<br/>Older Brother"]:::male
        å§å§["ğŸ‘§ å§å§<br/>Older Sister"]:::female
        ä½ ["ğŸŸ¡ ä½ /æˆ‘<br/>YOU"]:::highlight
        å¦»å­["ğŸ’‘ å¦»å­<br/>Wife"]:::female
        å¼Ÿå¼Ÿ["ğŸ‘¦ å¼Ÿå¼Ÿ<br/>Younger Brother"]:::male
        å¦¹å¦¹["ğŸ‘§ å¦¹å¦¹<br/>Younger Sister"]:::female
    end

    subgraph CHILDREN["ğŸ‘¶ å­å¥³ Children Generation"]
        direction LR
        å„¿å­["ğŸ‘¦ å„¿å­<br/>Son"]:::male
        å¥³å„¿["ğŸ‘§ å¥³å„¿<br/>Daughter"]:::female
    end

    %% Cross-subgraph connections
    çˆ¸çˆ¸ -.å©šå§» marriage.- å¦ˆå¦ˆ

    çˆ¸çˆ¸ --> ä½ 
    å¦ˆå¦ˆ --> ä½ 
    çˆ¸çˆ¸ --> å“¥å“¥
    å¦ˆå¦ˆ --> å“¥å“¥
    çˆ¸çˆ¸ --> å§å§
    å¦ˆå¦ˆ --> å§å§
    çˆ¸çˆ¸ --> å¼Ÿå¼Ÿ
    å¦ˆå¦ˆ --> å¼Ÿå¼Ÿ
    çˆ¸çˆ¸ --> å¦¹å¦¹
    å¦ˆå¦ˆ --> å¦¹å¦¹

    ä½  -.å©šå§» marriage.- å¦»å­

    ä½  --> å„¿å­
    å¦»å­ --> å„¿å­
    ä½  --> å¥³å„¿
    å¦»å­ --> å¥³å„¿

    %% Styles
    classDef male fill:#80ccff,stroke:#333,stroke-width:2px,color:#000
    classDef female fill:#ffb3d9,stroke:#333,stroke-width:2px,color:#000
    classDef highlight fill:#ffd700,stroke:#333,stroke-width:3px,color:#000
                </div>
            </div>
            <div class="scroll-hint" style="text-align: center; color: #666; font-size: 0.85rem; margin-top: 10px;">
                ğŸ‘† Click/Touch and drag to move | Zoom to enlarge<br/>
                ğŸ‘¨ Father's Side (left) | ğŸ‘© Mother's Side (right)<br/>
                Blue=ç”· Male | Pink=å¥³ Female | Gold=ä½  You
            </div>
        </div>

        <!-- Immediate Family -->
        <div class="category-section">
            <div class="category-header">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Your Immediate Family ç›´ç³»äº²å±</div>
            <div class="family-grid" id="immediate-family"></div>
        </div>

        <!-- Grandparents -->
        <div class="category-section">
            <div class="category-header">ğŸ‘´ğŸ‘µ Grandparents ç¥–çˆ¶æ¯/å¤–ç¥–çˆ¶æ¯</div>
            <div class="family-grid" id="grandparents"></div>
        </div>

        <!-- Uncles -->
        <div class="category-section">
            <div class="category-header">ğŸ‘¨ Uncles ä¼¯ä¼¯/å”å”/èˆ…èˆ…</div>
            <div class="family-grid" id="uncles"></div>
        </div>

        <!-- Aunts -->
        <div class="category-section">
            <div class="category-header">ğŸ‘© Aunts å§‘å¦ˆ/å§¨å¦ˆ/ä¼¯æ¯/å©¶å©¶</div>
            <div class="family-grid" id="aunts"></div>
        </div>

        <!-- Cousins -->
        <div class="category-section">
            <div class="category-header">ğŸ‘« Cousins å ‚å…„å¼Ÿå§å¦¹/è¡¨å…„å¼Ÿå§å¦¹</div>
            <div class="family-grid" id="cousins"></div>
        </div>

        <!-- Nephews & Nieces -->
        <div class="category-section">
            <div class="category-header">ğŸ‘¶ Nephews & Nieces ä¾„å­/ä¾„å¥³/å¤–ç”¥</div>
            <div class="family-grid" id="nephews-nieces"></div>
        </div>

        <!-- In-Laws -->
        <div class="category-section">
            <div class="category-header">ğŸ’‘ In-Laws å§»äº²</div>
            <div class="family-grid" id="in-laws"></div>
        </div>
    </div>

    <script type="module">
        // Menu toggle
        const menuToggle = document.getElementById('menu-toggle');
        const navMenu = document.getElementById('nav-menu');

        if (menuToggle && navMenu) {
            menuToggle.addEventListener('click', () => {
                navMenu.classList.toggle('active');
            });

            document.addEventListener('click', (e) => {
                if (!menuToggle.contains(e.target) && !navMenu.contains(e.target)) {
                    navMenu.classList.remove('active');
                }
            });
        }

        // Audio player
        const audioPlayer = new Audio();

        function playAudio(chinese) {
            const firstWord = chinese.split('/')[0].trim();
            const audioPath = `audio/${firstWord}.mp3`;
            audioPlayer.src = audioPath;
            audioPlayer.play().catch(err => {
                console.log('Audio not available:', audioPath);
            });
        }

        // Family data
        const familyData = {
            'immediate-family': [
                { english: "Your Mom", chinese: "å¦ˆå¦ˆ", pinyin: "mÄma" },
                { english: "Your Dad", chinese: "çˆ¸çˆ¸", pinyin: "bÃ ba" },
                { english: "Your Wife", chinese: "å¦»å­ / è€å©†", pinyin: "qÄ«zi / lÇopÃ³" },
                { english: "Your Husband", chinese: "ä¸ˆå¤« / è€å…¬", pinyin: "zhÃ ngfÅ« / lÇogÅng" },
                { english: "Your older brother", chinese: "å“¥å“¥", pinyin: "gÄ“gÄ“" },
                { english: "Your older sister", chinese: "å§å§", pinyin: "jiÄ›jiÄ›" },
                { english: "Your younger brother", chinese: "å¼Ÿå¼Ÿ", pinyin: "dÃ¬dÃ¬" },
                { english: "Your younger sister", chinese: "å¦¹å¦¹", pinyin: "mÃ¨imei" },
                { english: "Your son", chinese: "å„¿å­", pinyin: "Ã©rzi" },
                { english: "Your daughter", chinese: "å¥³å„¿", pinyin: "nÇš'Ã©r" }
            ],
            'grandparents': [
                { english: "Grandmother (Dad's side)", chinese: "å¥¶å¥¶", pinyin: "nÇinai" },
                { english: "Grandmother (Mom's side)", chinese: "å¤–å©†", pinyin: "wÃ ipÃ³" },
                { english: "Grandfather (Dad's side)", chinese: "çˆ·çˆ·", pinyin: "yÃ©yÃ©" },
                { english: "Grandfather (Mom's side)", chinese: "å¤–å…¬", pinyin: "wÃ igÅng" }
            ],
            'uncles': [
                { english: "Dad's older brother", chinese: "ä¼¯ä¼¯", pinyin: "bÃ³bo" },
                { english: "Dad's younger brother", chinese: "å”å”", pinyin: "shÅ«shu" },
                { english: "Dad's sister's husband", chinese: "å§‘å¤«", pinyin: "gÅ«fÅ«" },
                { english: "Mom's brother", chinese: "èˆ…èˆ…", pinyin: "jiÃ¹jiu" }
            ],
            'aunts': [
                { english: "Dad's older sister", chinese: "å§‘å¦ˆ", pinyin: "gÅ«mÄ" },
                { english: "Dad's younger sister", chinese: "å§‘å§‘", pinyin: "gÅ«gÅ«" },
                { english: "Dad's older brother's wife", chinese: "ä¼¯æ¯", pinyin: "bÃ³mÇ”" },
                { english: "Dad's younger brother's wife", chinese: "å©¶å©¶", pinyin: "shÄ›nshÄ›n" },
                { english: "Mom's older sister", chinese: "å§¨å¦ˆ", pinyin: "yÃ­mÄ" },
                { english: "Mom's younger sister", chinese: "é˜¿å§¨", pinyin: "ÄyÃ­" },
                { english: "Mom's brother's wife", chinese: "èˆ…æ¯", pinyin: "jiÃ¹mÇ”" }
            ],
            'cousins': [
                { english: "Dad's sibling's son (older)", chinese: "å ‚å…„", pinyin: "tÃ¡ng xiÅng" },
                { english: "Dad's sibling's son (younger)", chinese: "å ‚å¼Ÿ", pinyin: "tÃ¡ng dÃ¬" },
                { english: "Dad's sibling's daughter (older)", chinese: "å ‚å§", pinyin: "tÃ¡ng jiÄ›" },
                { english: "Dad's sibling's daughter (younger)", chinese: "å ‚å¦¹", pinyin: "tÃ¡ng mÃ¨i" },
                { english: "Mom's sibling's son (older)", chinese: "è¡¨å“¥", pinyin: "biÇo gÄ“" },
                { english: "Mom's sibling's son (younger)", chinese: "è¡¨å¼Ÿ", pinyin: "biÇo dÃ¬" },
                { english: "Mom's sibling's daughter (older)", chinese: "è¡¨å§", pinyin: "biÇo jiÄ›" },
                { english: "Mom's sibling's daughter (younger)", chinese: "è¡¨å¦¹", pinyin: "biÇo mÃ¨i" }
            ],
            'nephews-nieces': [
                { english: "Brother's son", chinese: "ä¾„å­", pinyin: "zhÃ­zi" },
                { english: "Sister's son", chinese: "å¤–ç”¥", pinyin: "wÃ ishÄ“ng" },
                { english: "Brother's daughter", chinese: "ä¾„å¥³", pinyin: "zhÃ­nÇš" },
                { english: "Sister's daughter", chinese: "å¤–ç”¥å¥³", pinyin: "wÃ ishengnÇš" }
            ],
            'in-laws': [
                { english: "Husband's father", chinese: "å…¬å…¬", pinyin: "gÅnggong" },
                { english: "Wife's father", chinese: "å²³çˆ¶", pinyin: "yuÃ¨fÃ¹" },
                { english: "Husband's mother", chinese: "å©†å©†", pinyin: "pÃ³po" },
                { english: "Wife's mother", chinese: "å²³æ¯", pinyin: "yuÃ¨mÇ”" },
                { english: "Older sister's husband", chinese: "å§å¤«", pinyin: "jiÄ›fÅ«" },
                { english: "Younger sister's husband", chinese: "å¦¹å¤«", pinyin: "mÃ¨ifÅ«" },
                { english: "Older brother's wife", chinese: "å«‚å­", pinyin: "sÇozi" },
                { english: "Younger brother's wife", chinese: "å¼Ÿå¦‡", pinyin: "dÃ¬fÃ¹" }
            ]
        };

        function createFamilyCard(data) {
            const card = document.createElement('div');
            card.className = 'family-card';

            card.innerHTML = `
                <div class="english">${data.english}</div>
                <div class="chinese">${data.chinese}</div>
                <div class="pinyin">${data.pinyin}</div>
                <button class="audio-btn">ğŸ”Š å¬å‘éŸ³ Play Audio</button>
            `;

            const audioBtn = card.querySelector('.audio-btn');
            audioBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                playAudio(data.chinese);
            });

            card.addEventListener('click', () => {
                playAudio(data.chinese);
            });

            return card;
        }

        // Render all categories
        Object.keys(familyData).forEach(categoryId => {
            const container = document.getElementById(categoryId);
            familyData[categoryId].forEach(item => {
                container.appendChild(createFamilyCard(item));
            });
        });
    </script>

    <!-- Zoom and Pan controls for family tree -->
    <script>
        let currentZoom = 1;
        let panX = 0;
        let panY = 0;
        let isDragging = false;
        let startX = 0;
        let startY = 0;
        let scrollLeft = 0;
        let scrollTop = 0;

        function zoomIn() {
            currentZoom = Math.min(currentZoom + 0.2, 3);
            applyTransform();
        }

        function zoomOut() {
            currentZoom = Math.max(currentZoom - 0.2, 0.5);
            applyTransform();
        }

        function resetZoom() {
            currentZoom = 1;
            panX = 0;
            panY = 0;
            applyTransform();

            // Reset scroll position
            const container = document.querySelector('.tree-container');
            if (container) {
                container.scrollLeft = 0;
                container.scrollTop = 0;
            }
        }

        function applyTransform() {
            const mermaidDiv = document.querySelector('.mermaid');
            if (mermaidDiv) {
                mermaidDiv.style.transform = `translate(${panX}px, ${panY}px) scale(${currentZoom})`;
            }
        }

        // Touch and mouse drag support
        window.addEventListener('load', () => {
            const container = document.querySelector('.tree-container');
            const mermaidDiv = document.querySelector('.mermaid');

            if (!container || !mermaidDiv) return;

            // Mouse events
            mermaidDiv.addEventListener('mousedown', (e) => {
                isDragging = true;
                mermaidDiv.style.cursor = 'grabbing';
                startX = e.pageX - panX;
                startY = e.pageY - panY;
                e.preventDefault();
            });

            document.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                panX = e.pageX - startX;
                panY = e.pageY - startY;
                applyTransform();
            });

            document.addEventListener('mouseup', () => {
                if (isDragging) {
                    isDragging = false;
                    mermaidDiv.style.cursor = 'grab';
                }
            });

            // Touch events
            mermaidDiv.addEventListener('touchstart', (e) => {
                if (e.touches.length === 1) {
                    isDragging = true;
                    startX = e.touches[0].pageX - panX;
                    startY = e.touches[0].pageY - panY;
                }
            });

            mermaidDiv.addEventListener('touchmove', (e) => {
                if (!isDragging || e.touches.length !== 1) return;
                e.preventDefault();
                panX = e.touches[0].pageX - startX;
                panY = e.touches[0].pageY - startY;
                applyTransform();
            });

            mermaidDiv.addEventListener('touchend', () => {
                isDragging = false;
            });

            // Set initial cursor
            mermaidDiv.style.cursor = 'grab';
        });
    </script>

    <!-- Mermaid.js for family tree visualization -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: false,
                htmlLabels: true,
                curve: 'basis',
                nodeSpacing: 120,
                rankSpacing: 120,
                padding: 30
            },
            themeVariables: {
                fontSize: '20px',
                fontFamily: 'Arial, sans-serif'
            }
        });
    </script>
</body>
</html>
